#!/bin/bash
#
# CRM 웹앱 재시작 스크립트 (5000번 포트만 안전하게)
#

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

echo "=========================================="
echo "CRM 웹앱 재시작"
echo "=========================================="
echo ""

# 1. 중지
echo "[1/2] 기존 프로세스 중지..."
"$SCRIPT_DIR/stop.sh" || true
echo ""

# 2. 잠시 대기 (포트 완전히 해제되도록)
echo "포트 해제 대기 (3초)..."
sleep 3
echo ""

# 3. 시작
echo "[2/2] 새 프로세스 시작..."
"$SCRIPT_DIR/start.sh"

echo ""
echo "=========================================="
echo "✓ 재시작 완료"
echo "=========================================="
